<!doctype html>
<html class="default no-js">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>diox</title>
	<meta name="description" content="Documentation for diox">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>

<body>
	<header>
		<div class="tsd-page-toolbar">
			<div class="container">
				<div class="table-wrap">
					<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
						<div class="field">
							<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
							<input id="tsd-search-field" type="text" />
						</div>
						<ul class="results">
							<li class="state loading">Preparing search index...</li>
							<li class="state failure">The search index is not available</li>
						</ul>
						<a href="index.html" class="title">diox</a>
					</div>
					<div class="table-cell" id="tsd-widgets">
						<div id="tsd-filter">
							<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
							<div class="tsd-filter-group">
								<div class="tsd-select" id="tsd-filter-visibility">
									<span class="tsd-select-label">All</span>
									<ul class="tsd-select-list">
										<li data-value="public">Public</li>
										<li data-value="protected">Public/Protected</li>
										<li data-value="private" class="selected">All</li>
									</ul>
								</div>
								<input type="checkbox" id="tsd-filter-inherited" checked />
								<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
								<input type="checkbox" id="tsd-filter-externals" checked />
								<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
								<input type="checkbox" id="tsd-filter-only-exported" />
								<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
							</div>
						</div>
						<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
					</div>
				</div>
			</div>
		</div>
		<div class="tsd-page-title">
			<div class="container">
				<ul class="tsd-breadcrumb">
					<li>
						<a href="globals.html">Globals</a>
					</li>
				</ul>
				<h1>diox</h1>
			</div>
		</div>
	</header>
	<div class="container container-main">
		<div class="row">
			<div class="col-8 col-content">
				<div class="tsd-panel tsd-typography">
					<a href="#diox" id="diox" style="color: inherit; text-decoration: none;">
						<h1>diox</h1>
					</a>
					<p>Complete state management for both front and back ends.</p>
					<p><a href="https://travis-ci.org/openizr/diox"><img
								src="https://travis-ci.org/openizr/diox.svg?branch=master" alt="Build Status"></a>
						<a href="https://coveralls.io/github/openizr/diox"><img
								src="https://coveralls.io/repos/github/openizr/diox/badge.svg" alt="Coverage Status"></a>
						<a href="https://badge.fury.io/js/diox"><img src="https://badge.fury.io/js/diox.svg" alt="npm version"></a>
						<a href="https://www.npmjs.com/package/diox"><img src="https://img.shields.io/npm/dm/diox.svg"
								alt="Downloads"></a></p>
					<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
						<h2>Installation</h2>
					</a>
					<pre><code class="language-bash">yarn add diox</code></pre>
					<a href="#motivations" id="motivations" style="color: inherit; text-decoration: none;">
						<h2>Motivations</h2>
					</a>
					<p>This framework is a mix between Redux and Vuex. Both of them have some drawbacks which makes
						development of large-scale applications more and more complex over time. diox brings significant
						improvements:</p>
					<ul>
						<li>100% standalone (no dependency)</li>
						<li>Extremely light (~300 lines of code, 1.7Kb gzipped)</li>
						<li>Fast and optimized by design</li>
						<li>Scalable out of the box without using any additional NPM module, thanks to the concept of Modules</li>
						<li>Compatible with any front-end library such as React or VueJS, using a unified syntax</li>
						<li>Easy to use, with a very small learning curve and simple concepts</li>
						<li>Based on the Observer Design Pattern, which means you can subscribe to state changes, (not possible in
							Vuex for instance)</li>
					</ul>
					<a href="#integrations-with-ui-frameworks" id="integrations-with-ui-frameworks"
						style="color: inherit; text-decoration: none;">
						<h2>Integrations with UI frameworks</h2>
					</a>
					<p>Several official connectors are available for most common UI frameworks:</p>
					<ul>
						<li>React: <a href="https://github.com/openizr/diox-react">diox-react</a></li>
						<li>VueJS: <a href="https://github.com/openizr/diox-vue">diox-vue</a></li>
					</ul>
					<p>In addition, the <a href="https://github.com/openizr/diox-cloner">diox-cloner</a> package makes it easy to
						perform deep copies and deep merges of JavaScript objects to keep your functions pure.</p>
					<a href="#concepts" id="concepts" style="color: inherit; text-decoration: none;">
						<h2>Concepts</h2>
					</a>
					<a href="#subscription" id="subscription" style="color: inherit; text-decoration: none;">
						<h3>Subscription</h3>
					</a>
					<p>A subscription is a <a href="https://en.wikipedia.org/wiki/Pure_function">pure function</a> that takes an
						object in parameter (the state) and performs any operation with it. Subscriptions are called each
						time a change happens on the state.</p>
					<pre><code class="language-typescript">
<span class="hljs-keyword">const</span> subscription = <span class="hljs-function">(<span class="hljs-params">newState</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'State has changed!'</span>, newState);
};
</code></pre>
					<a href="#mutators" id="mutators" style="color: inherit; text-decoration: none;">
						<h3>Mutators</h3>
					</a>
					<p>A mutator is also a pure function that returns a copy of an object (the state) depending on the
						desired type of change (mutation). In diox, mutators are in charge of performing synchronous changes
						on the internal state.</p>
					<pre><code class="language-typescript">
<span class="hljs-keyword">const</span> myMutator = <span class="hljs-function">(<span class="hljs-params">{ state }, mutation</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (mutation === <span class="hljs-string">'ADD'</span>) {
    <span class="hljs-keyword">return</span> {
      count: state.count + <span class="hljs-number">1</span>,
    };
  }
  <span class="hljs-comment">// If this is the very first time mutator is called, state has not been defined yet and we must</span>
  <span class="hljs-comment">// return an initial value.</span>
  <span class="hljs-keyword">if</span> (state === <span class="hljs-literal">undefined</span>) {
    <span class="hljs-keyword">return</span> {
      count: <span class="hljs-number">0</span>,
    };
  }
  <span class="hljs-comment">// By default, just return a copy of the current state.</span>
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.assign({}, state);
};
</code></pre>
					<a href="#dispatchers" id="dispatchers" style="color: inherit; text-decoration: none;">
						<h3>Dispatchers</h3>
					</a>
					<p>A dispatcher is a function that performs one or several calls to mutators depending on the desired
						type of action. Dispatchers cannot update state directly as it&#39;s the mutators&#39; job.</p>
					<pre><code class="language-typescript">
<span class="hljs-keyword">const</span> myDispatcher = <span class="hljs-function">(<span class="hljs-params">{ mutate, hash }, action</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (action === <span class="hljs-string">'ASYNC_ADD'</span>) {
    <span class="hljs-comment">// `hash` tells diox which mutator should be called with the given mutation (see Modules).</span>
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> mutate(hash, <span class="hljs-string">'ADD'</span>), <span class="hljs-number">500</span>);
  }
};
</code></pre>
					<a href="#modules" id="modules" style="color: inherit; text-decoration: none;">
						<h3>Modules</h3>
					</a>
					<p>A module contains a part of your app&#39;s global state, managing a specific concern (e.g. list of users,
						list of blog articles, app status, ...). By creating several modules, and combining them, you can
						build complex, evolutive, infinitely scalable apps without worrying about performance. Each module
						is composed of a Mutator and optionally a Dispatcher.</p>
					<pre><code class="language-typescript">
<span class="hljs-keyword">const</span> myModule = {
  mutator: myMutator,
  dispatcher: myDispatcher,
};
</code></pre>
					<a href="#store" id="store" style="color: inherit; text-decoration: none;">
						<h3>Store</h3>
					</a>
					<p>The Store is the entity that ties everything together. Modules are registered into the Store,
						using a unique identifier (so-called &quot;hash&quot;). You can subscribe to changes on registered modules,
						combine modules, or apply middlewares to achieve more complex goals.</p>
					<pre><code class="language-typescript">
<span class="hljs-comment">// Instanciating store...</span>
<span class="hljs-keyword">const</span> store = <span class="hljs-keyword">new</span> Store();

<span class="hljs-comment">// Adding a global middleware triggered at each state change on any module...</span>
store.use(<span class="hljs-function">(<span class="hljs-params">newState</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New state !'</span>, newState);
});

<span class="hljs-comment">// Registering modules...</span>
store.register(<span class="hljs-string">'a'</span>, moduleA);
store.register(<span class="hljs-string">'b'</span>, moduleB);

<span class="hljs-comment">// Creating a combiner which mixes `a` and `b` modules...</span>
store.combine(<span class="hljs-string">'c'</span>, {
  <span class="hljs-string">'a'</span>: <span class="hljs-function"><span class="hljs-params">newState</span> =&gt;</span> ({ a: newState.increment }),
  <span class="hljs-string">'b'</span>: <span class="hljs-function"><span class="hljs-params">newState</span> =&gt;</span> ({ b: newState }),
});

<span class="hljs-comment">// Subscribing to the combination of `a`  and `b` modules...</span>
store.subscribe(<span class="hljs-string">'c'</span>, <span class="hljs-function">(<span class="hljs-params">newState</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New mixed state!'</span>, newState.a, newState.b);
});

</code></pre>
					<a href="#combiners" id="combiners" style="color: inherit; text-decoration: none;">
						<h3>Combiners</h3>
					</a>
					<p>You can mix the result of several module&#39;s changes by using a Combiner. It is a pure function that
						listens to changes on one or several modules, and returns a mix of their states for easier processing.
						For instance, imagine you have a module containing all the articles of a blog, and another one
						containing the list of article&#39;s authors. Instead of subscibing to both modules, you can create a
						combiner that will generate a proper structure with all info (articles + authors) so you just have
						to subscribe to this combiner and forget about managing several sources of data.</p>
					<a href="#middlewares" id="middlewares" style="color: inherit; text-decoration: none;">
						<h3>Middlewares</h3>
					</a>
					<p>Middlewares can be useful in some situations where you want to listen to all states changes on all
						modules and trigger similar processing on all of them. For instance, you may want to implement a
						&quot;time-travel&quot; tool, keeping a complete history of states changes over time to revert them if
						necessary.</p>
					<a href="#complete-example" id="complete-example" style="color: inherit; text-decoration: none;">
						<h3>Complete example</h3>
					</a>
					<p>Example in diox:</p>
					<pre><code class="language-typescript">
<span class="hljs-keyword">import</span> { Store } <span class="hljs-keyword">from</span> <span class="hljs-string">'diox'</span>;

<span class="hljs-keyword">const</span> moduleA = {
  mutator: <span class="hljs-function">(<span class="hljs-params">{ state }, mutation</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (mutation === <span class="hljs-string">'ADD'</span>) {
      <span class="hljs-keyword">return</span> {
        increment: state.increment + <span class="hljs-number">1</span>,
      };
    }
    <span class="hljs-keyword">return</span> (state === <span class="hljs-literal">undefined</span>)
      ? { increment: <span class="hljs-number">0</span> }
      : <span class="hljs-built_in">Object</span>.assign({}, state);
  },
};

<span class="hljs-keyword">const</span> moduleB = {
  mutator: <span class="hljs-function">(<span class="hljs-params">{ state }, mutation</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (mutation === <span class="hljs-string">'SUB'</span>) {
      <span class="hljs-keyword">return</span> {
        decrement: state.decrement - <span class="hljs-number">1</span>,
      };
    }
    <span class="hljs-keyword">return</span> (state === <span class="hljs-literal">undefined</span>)
      ? { decrement: <span class="hljs-number">1000</span> }
      : <span class="hljs-built_in">Object</span>.assign({}, state);
  },
  dispatcher: <span class="hljs-function">(<span class="hljs-params">{ mutate, hash }, action</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (action === <span class="hljs-string">'ASYNC_SUB'</span>) {
      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> { mutate(hash, <span class="hljs-string">'SUB'</span>); }, <span class="hljs-number">1000</span>);
    }
  },
};

<span class="hljs-keyword">const</span> store : Store = <span class="hljs-keyword">new</span> Store();

store.use(<span class="hljs-function">(<span class="hljs-params">newState</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New state !'</span>, newState);
});

store.register(<span class="hljs-string">'a'</span>, moduleA);
store.register(<span class="hljs-string">'b'</span>, moduleB);

store.combine(<span class="hljs-string">'c'</span>, {
  <span class="hljs-string">'a'</span>: <span class="hljs-function"><span class="hljs-params">newState</span> =&gt;</span> ({ a: newState.increment }),
  <span class="hljs-string">'b'</span>: <span class="hljs-function"><span class="hljs-params">newState</span> =&gt;</span> ({ b: newState }),
});

store.subscribe(<span class="hljs-string">'a'</span>, <span class="hljs-function">(<span class="hljs-params">newState</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New state from a !'</span>, newState);
});

store.subscribe(<span class="hljs-string">'c'</span>, <span class="hljs-function">(<span class="hljs-params">newState</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New state from c !'</span>, newState);
});

store.mutate(<span class="hljs-string">'a'</span>, <span class="hljs-string">'ADD'</span>);
store.dispatch(<span class="hljs-string">'b'</span>, <span class="hljs-string">'ASYNC_SUB'</span>);
</code></pre>
					<p>The equivalent in Vuex is:</p>
					<pre><code class="language-typescript">
<span class="hljs-keyword">import</span> Vuex <span class="hljs-keyword">from</span> <span class="hljs-string">'vuex'</span>;

<span class="hljs-keyword">const</span> moduleA = {
  state: {
    increment: <span class="hljs-number">0</span>,
  },
  mutations: {
    ADD (state) {
      state.increment++;
    },
  },
};

<span class="hljs-keyword">const</span> moduleB = {
  state: {
    decrement: <span class="hljs-number">100</span>,
  },
  mutations: {
    SUB (state) {
      state.increment++;
    },
  },
  actions: {
    ASYNC_SUB ({ commit }) {
      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        commit(<span class="hljs-string">'SUB'</span>);
      }, <span class="hljs-number">1000</span>);
    },
  },
};

<span class="hljs-keyword">const</span> store = <span class="hljs-keyword">new</span> Vuex.Store({
  modules: {
    a: moduleA,
    b: moduleB
  }
});

<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New state !'</span>, store.state.a);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New state !'</span>, store.state.b);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New state from a !'</span>, store.state.a);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New state from c !'</span>, store.state);
storeA.commit(<span class="hljs-string">'ADD'</span>)
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New state !'</span>, store.state.a);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New state from a !'</span>, store.state.a);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New state from c !'</span>, store.state);
store.dispatch(<span class="hljs-string">'ASYNC_SUB'</span>);
setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New state !'</span>, store.state.b);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New state from c !'</span>, store.state);
}, <span class="hljs-number">2000</span>);
</code></pre>
					<p>The above examples will display in console :</p>
					<pre><code class="language-bash">New state ! { increment: 0 }
New state ! { decrement: 1000 }
New state from a ! { increment: 0 }
New state from c ! { a: 0, b: { decrement: 1000 } }
New state ! { increment: 1 }
New state from a ! { increment: 1 }
New state from c ! { a: 1, b: { decrement: 1000 } }
New state ! { decrement: 999 }
New state from c ! { a: 1, b: { decrement: 999 } }</code></pre>
					<a href="#api-documentation" id="api-documentation" style="color: inherit; text-decoration: none;">
						<h2>API documentation</h2>
					</a>
					<p>The complete API documentation is available <a href="https://matthieujabbour.github.io/diox">here</a></p>
					<a href="#contributing" id="contributing" style="color: inherit; text-decoration: none;">
						<h2>Contributing</h2>
					</a>
					<p>See the <a href="https://github.com/openizr/diox/blob/master/CONTRIBUTING.md">Contribution guide</a></p>
					<a href="#license" id="license" style="color: inherit; text-decoration: none;">
						<h2>License</h2>
					</a>
					<p><a href="https://github.com/openizr/diox/blob/master/LICENSE">MIT</a></p>
					<p>Copyright (c) Matthieu Jabbour.</p>
				</div>
			</div>
			<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
				<nav class="tsd-navigation primary">
					<ul>
						<li class="globals  ">
							<a href="globals.html"><em>Globals</em></a>
						</li>
						<li class=" tsd-kind-module">
							<a href="modules/_store_.html">&quot;<wbr>Store&quot;</a>
						</li>
					</ul>
				</nav>
				<nav class="tsd-navigation secondary menu-sticky">
					<ul class="before-current">
					</ul>
				</nav>
			</div>
		</div>
	</div>
	<footer class="with-border-bottom">
		<div class="container">
			<h2>Legend</h2>
			<div class="tsd-legend-group">
				<ul class="tsd-legend">
					<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
				</ul>
				<ul class="tsd-legend">
					<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
				</ul>
				<ul class="tsd-legend">
					<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
				</ul>
			</div>
		</div>
	</footer>
	<div class="container tsd-generator">
		<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
	</div>
	<div class="overlay"></div>
	<script src="assets/js/main.js"></script>
	<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>

</html>